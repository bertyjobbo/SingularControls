"use strict";function S4(){return((1+Math.random())*65536|0).toString(16).substring(1)}function guid(){return(S4()+S4()+"-"+S4()+"-4"+S4().substr(0,3)+"-"+S4()+"-"+S4()+S4()+S4()).toLowerCase()}window.SingularControls==undefined&&(window.SingularControls={});SingularControls.TranslateModule=angular.module("sgTranslate",["ng"]),function(n,t){n.SgTranslateConfigProvider=[function(){var n=this;n.setTranslationRequestPromise=function(t){return n.getTranslationRequestPromise=t,n};n.setMaxTranslationCacheLength=function(t){return n.maxTranslationCacheLength=t<500?500:t,n};n.getTranslationRequestPromise=undefined;n.maxTranslationCacheLength=500;n.setCacheKeyMethod=function(t){return n.cacheKeyMethod=t,n};n.cacheKeyMethod=function(n){return"$$$"+n+"$$$"};n.$get=[function(){return n}]}];t.provider("sgTranslateConfig",n.SgTranslateConfigProvider);n.SgTranslationFactory=["sgTranslateConfigProvider",function(n){var t={translationCache:{},getMaxCacheLength:function(){return n.maxTranslationCacheLength},emptyCache:function(){this.currentTranslationRequests={};this.currentTranslationResponses={};this.currentTranslationRequestsLength=0;this.translationCacheLength=0;this.translationCache={}},currentTranslationRequests:{},currentTranslationResponses:{},currentTranslationRequestsLength:0,addTranslationForCurrentRequest:function(i,r){var u,e=!1,o,f;r.hasSgTranslateTitle?(u=r.sgTranslateTitle,r.hasSgTranslateTitle=undefined,e=!0):i.hasClass("sg-translate")?u=i.html():i.attr("sg-translate")!==undefined?u=r.sgTranslate:i[0].tagName=="SG-TRANSLATE"&&(u=i.html());u&&(o=t.translationCache[n.cacheKeyMethod(u)],f=guid(),o?t.currentTranslationResponses[u+"$$"+f]={element:i,value:o,attrs:r,hasSgTranslateTitle:e,guid:f,key:u}:(t.currentTranslationRequests[u+"$$"+f]={element:i,attrs:r,hasSgTranslateTitle:e,guid:f,key:u},t.currentTranslationRequestsLength++))},getTranslationsForCurrentRequest:function(){var i=[];for(var r in t.currentTranslationRequests)i.push(r.split("$$")[0]);return n.getTranslationRequestPromise(i)},translationCacheLength:0,getTranslations:function(i){var r={},e={},o=0,u=t.$q.defer(),f,s;if(i.forEach(function(i){var u=t.translationCache[n.cacheKeyMethod(i)];u?r[i]=u:(e[i]={},o++)}),o>0&&n.getTranslationRequestPromise!==undefined){f=[];for(s in e)f.push(s);n.getTranslationRequestPromise(f).success(function(i){i.forEach(function(i){r[i.Key]=i.Value;t.translationCacheLength<n.maxTranslationCacheLength&&(t.translationCache[n.cacheKeyMethod(i.Key)]=i.Value,t.translationCacheLength++)});u.resolve(r)})}else u.resolve(r);return u.promise},$q:undefined,$http:undefined};this.$get=["$q",function(n){return t.$q=n,t}]}];t.provider("sgTranslationFactory",n.SgTranslationFactory);n.SgTranslationService=[function(){var n={getTranslations:function(t){return n.sgTranslationFactory.getTranslations(t)},emptyCache:function(){n.sgTranslationFactory.emptyCache();n.listItemsCache={}},listItemsCache:{},listItemsCacheCount:0,getListItems:function(t,i){var u=t+"$$$"+(i==undefined||i==null||i==""?"":JSON.stringify(i)),f=n.listItemsCache[u],r=n.$q.defer();return f?r.resolve(f):n.$http.post(t,i).success(function(t){n.listItemsCacheCount<n.sgTranslationFactory.getMaxCacheLength()-t.length&&(n.listItemsCache[u]=t,n.listItemsCacheCount++);r.resolve(t)}).error(function(){r.resolve({})}),r.promise},sgTranslationFactory:undefined};this.$get=["sgTranslationFactory","$q","$http",function(t,i,r){return n.sgTranslationFactory=t,n.$q=i,n.$http=r,n}]}];t.provider("sgTranslationService",n.SgTranslationService);t.directive("sgTranslate",["sgTranslationFactory",function(n){return{restrict:"AEC",requires:"sgTranslateProcessor",transclude:!1,link:function(t,i,r){n.addTranslationForCurrentRequest(i,r)}}}]);t.directive("sgTranslateTitle",["sgTranslationFactory",function(n){return{restrict:"A",requires:"sgTranslateProcessor",transclude:!1,link:function(t,i,r){r.hasSgTranslateTitle=!0;n.addTranslationForCurrentRequest(i,r)}}}]);t.directive("sgTranslateProcessor",["sgTranslateConfig","sgTranslationFactory",function(n,t){var i=function(n){var r,i;for(r in t.currentTranslationResponses)i=t.currentTranslationResponses[r],i.hasSgTranslateTitle?(i.element.attr("title",i.value),i.element.removeAttr("sg-translate-title")):i.element.hasClass("sg-translate")||i.element.attr("sg-translate")!==undefined?i.element.html(i.value):i.element[0].tagName=="SG-TRANSLATE"&&(i.element.after(i.value),i.element.remove());t.currentTranslationRequests={};t.currentTranslationRequestsLength=0;t.currentTranslationResponses={};n.remove()};return{restrict:"AEC",transclude:!0,link:function(r,u){n.getTranslationRequestPromise&&t.currentTranslationRequestsLength>0?t.getTranslationsForCurrentRequest().success(function(r){r.forEach(function(i){var u=[],e,f,o,r;for(e in t.currentTranslationRequests)f=t.currentTranslationRequests[e],f.key==i.Key&&u.push(f);if(u.length>0)for(o in u)r=u[o],t.currentTranslationResponses[i.Key+"$$"+r.guid]={element:r.element,value:i.Value,attrs:r.attrs,hasSgTranslateTitle:r.hasSgTranslateTitle,key:i.Key,guid:r.guid},t.translationCacheLength<n.maxTranslationCacheLength&&(t.translationCache[n.cacheKeyMethod(i.Key)]=i.Value,t.translationCacheLength++)});i(u)}).error(function(n){console.log("Error getting translation data: "+(n.Message||"Unknown error"))}):i(u)}}}])}(SingularControls,SingularControls.TranslateModule);
/*
//# sourceMappingURL=sgTranslate.min.js.map
*/